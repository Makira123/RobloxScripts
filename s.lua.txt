-- FreezeAnimalSystem by ChatGPT
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")

-- RemoteEvent Setup
local eventName = "SafeFreezeAnimalRequest"
local freezeEvent = ReplicatedStorage:FindFirstChild(eventName) or Instance.new("RemoteEvent", ReplicatedStorage)
freezeEvent.Name = eventName

-- Server Script Setup
if not game:GetService("ServerScriptService"):FindFirstChild("FreezeHandler") then
    local handler = Instance.new("Script")
    handler.Name = "FreezeHandler"
    handler.Source = [[
        local ReplicatedStorage = game:GetService("ReplicatedStorage")
        local freezeEvent = ReplicatedStorage:WaitForChild("SafeFreezeAnimalRequest")

        freezeEvent.OnServerEvent:Connect(function(player)
            local character = player.Character
            if not character then return end

            local animal = workspace:FindFirstChild(player.Name .. "_Pet")
            if not animal or not animal:IsA("Model") then
                warn("สัตว์ของผู้เล่นไม่พบ")
                return
            end

            if animal:FindFirstChild("Humanoid") then
                animal.Humanoid:Move(Vector3.zero)
            end

            local root = character:FindFirstChild("HumanoidRootPart")
            local animalRoot = animal:FindFirstChild("PrimaryPart") or animal:FindFirstChild("HumanoidRootPart")

            if root and animalRoot then
                animal:SetPrimaryPartCFrame(root.CFrame * CFrame.new(2, 0, 2))
            end
        end)
    ]]
    handler.Parent = game:GetService("ServerScriptService")
end

-- LocalScript GUI
local player = Players.LocalPlayer
local gui = Instance.new("ScreenGui")
gui.Name = "FreezeAnimalUI"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local button = Instance.new("TextButton")
button.Size = UDim2.new(0, 150, 0, 50)
button.Position = UDim2.new(0.5, -75, 0.9, 0)
button.Text = "หยุดและดึงสัตว์"
button.BackgroundColor3 = Color3.fromRGB(100, 200, 100)
button.Parent = gui

button.MouseButton1Click:Connect(function()
    ReplicatedStorage:WaitForChild(eventName):FireServer()
end)